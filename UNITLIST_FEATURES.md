# UnitList.vue åŠŸèƒ½æ¨¡å—æ¸…å•

## ğŸ“‹ ç»„ä»¶æ¦‚è¿°

`UnitList.vue` æ˜¯å•å…ƒ/æˆ¿é—´/åºŠä½/è®¾å¤‡ç®¡ç†çš„æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£ç®¡ç†æ•´ä¸ªä½ç½®å±‚çº§ç»“æ„ã€‚

---

## âœ… å·²å®ç°çš„åŠŸèƒ½æ¨¡å—

### 1. Buildingï¼ˆæ¥¼æ ‹ï¼‰ç®¡ç†
- âœ… **åˆ›å»º Building**
  - æ”¯æŒ location_tag + building_name + floors
  - è¡¨å•éªŒè¯
- âœ… **ç¼–è¾‘ Building**
  - ä¿®æ”¹ location_tag å’Œ building_name
  - å†…è”ç¼–è¾‘æ¨¡å¼
- âœ… **åˆ é™¤ Building**
  - æ£€æŸ¥ä¾èµ–å…³ç³»ï¼ˆæ˜¯å¦æœ‰ unitsï¼‰
  - ç¡®è®¤å¯¹è¯æ¡†
- âœ… **åˆ é™¤ Floor**
  - æ£€æŸ¥ä¾èµ–å…³ç³»ï¼ˆæ˜¯å¦æœ‰ unitsï¼‰
  - è‡ªåŠ¨æ›´æ–° floors æ•°é‡
- âœ… **Building åˆ—è¡¨æ˜¾ç¤º**
  - å·¦ä¾§ Building å¡ç‰‡åˆ—è¡¨
  - é¡¶éƒ¨ Building æ ‡ç­¾åˆ—è¡¨
  - æ¥¼å±‚æŒ‰é’®ï¼ˆfloor1, floor2, ...ï¼‰
  - é€‰ä¸­çŠ¶æ€é«˜äº®
  - å±•å¼€/æ”¶èµ·æ¥¼å±‚

### 2. Unitï¼ˆå•å…ƒï¼‰ç®¡ç†
- âœ… **åˆ›å»º Unit**
  - è¡¨å•å­—æ®µï¼šunit_number, unit_name, unit_type, location_tag, area_tag, building, floor
  - æ”¯æŒ Facility/Home ç±»å‹
  - è¡¨å•éªŒè¯
- âœ… **ç¼–è¾‘ Unit**
  - ä¿®æ”¹åŸºæœ¬ä¿¡æ¯ï¼ˆunit_name, unit_type, area_tag, is_multi_person_room, is_public_space, timezoneï¼‰
  - æ¨¡æ€æ¡†ç¼–è¾‘
- âœ… **åˆ é™¤ Unit**
  - æ£€æŸ¥ä¾èµ–å…³ç³»ï¼ˆrooms, beds, devices, caregivers, residentsï¼‰
  - è¯¦ç»†é”™è¯¯æç¤º
- âœ… **Unit ç½‘æ ¼æ˜¾ç¤º**
  - æŒ‰ building + floor ç­›é€‰æ˜¾ç¤º
  - æŒ‰ unit_number æ•°å­—æ’åº
  - ç‚¹å‡»å•å…ƒæ ¼æ‰“å¼€ç¼–è¾‘æ¨¡æ€æ¡†
  - ç©ºå•å…ƒæ ¼ç”¨äºåˆ›å»ºæ–° Unit

### 3. Roomï¼ˆæˆ¿é—´ï¼‰ç®¡ç†
- âœ… **åˆ›å»º Room**
  - è¾“å…¥ room_name
  - è¡¨å•éªŒè¯
  - è‡ªåŠ¨åˆ·æ–°åˆ—è¡¨
- âœ… **ç¼–è¾‘ Room**
  - åŒå‡»æˆ–ç‚¹å‡»ç¼–è¾‘å›¾æ ‡
  - ä¿®æ”¹ room_name
  - å¤±ç„¦æˆ–å›è½¦ä¿å­˜
- âœ… **åˆ é™¤ Room**
  - åˆ é™¤ç¡®è®¤
  - è‡ªåŠ¨åˆ·æ–°åˆ—è¡¨
- âœ… **Room æ ‘å½¢ç»“æ„æ˜¾ç¤º**
  - æ ‘å½¢åˆ—è¡¨å±•ç¤º
  - å±•å¼€/æ”¶èµ·åŠŸèƒ½ï¼ˆæ˜¾ç¤º/éšè— bedsï¼‰
  - æ”¯æŒ unit_roomï¼ˆroom_name === unit_nameï¼‰è‡ªåŠ¨åˆ›å»º
- âœ… **Room æ’åº**
  - unit_roomï¼ˆroom_name === unit_nameï¼‰è‡ªåŠ¨æ’åœ¨ç¬¬ä¸€ä½

### 4. Bedï¼ˆåºŠä½ï¼‰ç®¡ç†
- âœ… **åˆ›å»º Bed**
  - è‡ªåŠ¨å‘½åè§„åˆ™ï¼šBedA, BedB, ..., BedZ
  - è‡ªåŠ¨é€‰æ‹©ä¸‹ä¸€ä¸ªå¯ç”¨å­—æ¯
  - éªŒè¯æ ¼å¼ï¼ˆBedA-BedZï¼‰
  - æ”¯æŒç›´æ¥æ·»åŠ åˆ° unit_room
  - æ”¯æŒæ·»åŠ åˆ°æŒ‡å®š Room
- âœ… **ç¼–è¾‘ Bed**
  - åŒå‡»æˆ–ç‚¹å‡»ç¼–è¾‘å›¾æ ‡
  - ä¿®æ”¹ bed_nameï¼ˆæ ¼å¼éªŒè¯ï¼šBedA-BedZï¼‰
  - å¤±ç„¦æˆ–å›è½¦ä¿å­˜
- âœ… **åˆ é™¤ Bed**
  - åˆ é™¤ç¡®è®¤
  - è‡ªåŠ¨åˆ·æ–°åˆ—è¡¨
- âœ… **Bed æ ‘å½¢ç»“æ„æ˜¾ç¤º**
  - ä½œä¸º Room çš„å­èŠ‚ç‚¹æ˜¾ç¤º
  - æ˜¾ç¤ºè®¾å¤‡ç¼©ç•¥å›¾ï¼ˆå½“ room å±•å¼€ä½†è®¾å¤‡åˆ—è¡¨æ”¶èµ·æ—¶ï¼‰
  - æ˜¾ç¤º bound_device_countï¼ˆå¦‚æœæœ‰ï¼‰

### 5. Deviceï¼ˆè®¾å¤‡ï¼‰ç®¡ç†
- âœ… **è®¾å¤‡ç»‘å®š**
  - ç»‘å®šåˆ° Roomï¼ˆbound_room_idï¼‰
  - ç»‘å®šåˆ° Bedï¼ˆbound_bed_idï¼‰
  - ç»‘å®šåˆ° Unitï¼ˆè‡ªåŠ¨åˆ›å»º unit_room å¹¶ç»‘å®šåˆ° roomï¼‰
  - SleepPad åªèƒ½ç»‘å®šåˆ° Bedï¼ˆé™åˆ¶ï¼‰
- âœ… **è®¾å¤‡è§£ç»‘**
  - å–æ¶ˆç»‘å®šï¼ˆæ¸…é™¤ bound_room_id, bound_bed_id, unit_idï¼‰
- âœ… **è®¾å¤‡æ˜¾ç¤º**
  - æ ‘å½¢ç»“æ„ï¼šRoom â†’ Bed â†’ Device
  - è®¾å¤‡ç¼©ç•¥å›¾ï¼ˆbed-device-thumbnailsï¼‰
  - è®¾å¤‡è¯¦ç»†è§†å›¾ï¼ˆå±•å¼€/æ”¶èµ·ï¼‰
  - è®¾å¤‡çŠ¶æ€æŒ‡ç¤ºå™¨ï¼ˆonline/offline/errorï¼‰
  - monitoring_enabled çŠ¶æ€æ˜¾ç¤º
- âœ… **è®¾å¤‡æ‹–æ‹½**
  - æ‹–æ‹½è®¾å¤‡åç§°ç»‘å®šåˆ° Room/Bed/Unit
  - æ‹–æ‹½è§†è§‰åé¦ˆï¼ˆdrag-over é«˜äº®ï¼‰
- âœ… **è®¾å¤‡é€‰æ‹©æ¨¡æ€æ¡†**
  - è¡¨æ ¼æ˜¾ç¤ºæ‰€æœ‰è®¾å¤‡
  - å¤é€‰æ¡†é€‰æ‹©ç»‘å®š
  - ç­›é€‰ SleepPadï¼ˆæ ¹æ®ç›®æ ‡ç±»å‹ï¼‰
- âœ… **è®¾å¤‡å®¹å™¨ï¼ˆDevice Containerï¼‰**
  - è®¾å¤‡æ¨¡å¼ï¼ˆisDeviceModeï¼‰
  - æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨è®¾å¤‡åˆ—è¡¨
  - å¤é€‰æ¡†ç»‘å®š/è§£ç»‘
  - ä¸ Unit ç¼–è¾‘å®¹å™¨å¹¶æ’æ˜¾ç¤º

### 6. äº¤äº’åŠŸèƒ½
- âœ… **å±•å¼€/æ”¶èµ·**
  - Building å±•å¼€/æ”¶èµ·æ¥¼å±‚
  - Room å±•å¼€/æ”¶èµ· Beds
  - Device å±•å¼€/æ”¶èµ·è¯¦ç»†ä¿¡æ¯
- âœ… **æŒ‰é’®äº’æ–¥**
  - "Add Room", "Add Bed", "Add Device" æŒ‰é’®äº’æ–¥
  - æ¿€æ´»çŠ¶æ€è§†è§‰åé¦ˆï¼ˆç»¿è‰²èƒŒæ™¯ï¼‰
- âœ… **æ¨¡æ€æ¡†å®šä½**
  - Edit Unit Modal å›ºå®šåœ¨å·¦ä¾§ 10%
  - Device æ¨¡å¼ä¸‹å¹¶æ’æ˜¾ç¤º
- âœ… **æ ‡ç­¾ç®¡ç†é›†æˆ**
  - location_tag ä¸‹æ‹‰é€‰æ‹©ï¼ˆä» tagsStoreï¼‰
  - area_tag ä¸‹æ‹‰é€‰æ‹©ï¼ˆä» tagsStoreï¼‰
  - æ”¯æŒæœç´¢å’Œåˆ›å»ºæ–° tag

### 7. æ•°æ®è·å–ä¸åˆ·æ–°
- âœ… **Building åˆ—è¡¨è·å–**
  - `fetchBuildings()`
- âœ… **Unit åˆ—è¡¨è·å–**
  - `fetchUnits()` - æ ¹æ® building + floor ç­›é€‰
  - `fetchAllUnits()` - è·å–æ‰€æœ‰ unitsï¼ˆç”¨äºè™šæ‹Ÿ buildingï¼‰
- âœ… **Room/Bed åˆ—è¡¨è·å–**
  - `fetchRoomsWithBeds()` - è·å–æŒ‡å®š unit çš„æ‰€æœ‰ rooms å’Œ beds
  - è‡ªåŠ¨æ’åºï¼ˆunit_room ä¼˜å…ˆï¼‰

---

## âŒ å¾…å®ç°çš„åŠŸèƒ½æ¨¡å—

### 1. Residentï¼ˆä½æˆ·ï¼‰ç®¡ç†
- âŒ **ç»‘å®š Resident åˆ° Unit**
  - è®¾ç½® `primary_resident_id`
  - è¡¨å•å­—æ®µå’ŒéªŒè¯
- âŒ **ç»‘å®š Resident åˆ° Bed**
  - è®¾ç½® `beds.resident_id`
  - é™åˆ¶ï¼šåªèƒ½ç»‘å®šåˆ° unit_room çš„ bed
- âŒ **æ˜¾ç¤º Resident ä¿¡æ¯**
  - åœ¨ Unit å¡ç‰‡æ˜¾ç¤º primary_resident åç§°
  - åœ¨ Bed èŠ‚ç‚¹æ˜¾ç¤ºç»‘å®šçš„ resident ä¿¡æ¯
- âŒ **Resident ä¾èµ–æ£€æŸ¥**
  - åˆ é™¤ Unit/Bed æ—¶æ£€æŸ¥æ˜¯å¦æœ‰ç»‘å®šçš„ resident
  - å½“å‰ `getUnitResidents()` æ˜¯å ä½ç¬¦å‡½æ•°

### 2. Caregiverï¼ˆæŠ¤ç†å‘˜ï¼‰ç®¡ç†
- âŒ **ç»‘å®š Caregiver åˆ° Unit**
  - ç®¡ç† `resident_caregivers` å…³è”
  - è¡¨å•å’Œåˆ—è¡¨æ˜¾ç¤º
- âŒ **Caregiver ä¾èµ–æ£€æŸ¥**
  - åˆ é™¤ Unit æ—¶æ£€æŸ¥æ˜¯å¦æœ‰ç»‘å®šçš„ caregiver
  - å½“å‰ `getUnitCaregivers()` æ˜¯å ä½ç¬¦å‡½æ•°

### 3. è®¾å¤‡è¯¦ç»†ä¿¡æ¯
- âŒ **è®¾å¤‡ç¼–è¾‘åŠŸèƒ½**
  - å½“å‰ `handleEditDevice()` åªæ˜¯å ä½ç¬¦ï¼ˆæ˜¾ç¤º "coming soon"ï¼‰
  - éœ€è¦å®ç°è®¾å¤‡å±æ€§ç¼–è¾‘ï¼ˆdevice_name, business_access, monitoring_enabledï¼‰
- âŒ **è®¾å¤‡çŠ¶æ€å®æ—¶æ›´æ–°**
  - å½“å‰çŠ¶æ€æ˜¯é™æ€çš„
  - éœ€è¦ WebSocket æˆ–è½®è¯¢æ›´æ–°

### 4. å¸ƒå±€é…ç½®
- âŒ **Unit Layout Config**
  - è¡¨å•å­—æ®µå­˜åœ¨ä½†æœªå®ç°ç¼–è¾‘åŠŸèƒ½
  - éœ€è¦é›†æˆ vue_radar å¸ƒå±€ç¼–è¾‘å™¨
- âŒ **Room Layout Config**
  - æ•°æ®åº“æ”¯æŒä½†å‰ç«¯æœªå®ç°
  - éœ€è¦æˆ¿é—´çº§ç‹¬ç«‹å¸ƒå±€ç¼–è¾‘

### 5. å‘Šè­¦é…ç½®
- âŒ **Alarm User IDs**
  - æ•°æ®åº“å­—æ®µå­˜åœ¨ä½†æœªå®ç°ç¼–è¾‘
  - éœ€è¦ç”¨æˆ·é€‰æ‹©å™¨
- âŒ **Alarm Tags**
  - æ•°æ®åº“å­—æ®µå­˜åœ¨ä½†æœªå®ç°ç¼–è¾‘
  - éœ€è¦æ ‡ç­¾é€‰æ‹©å™¨

### 6. é«˜çº§åŠŸèƒ½
- âŒ **æ‰¹é‡æ“ä½œ**
  - æ‰¹é‡åˆ é™¤ rooms/beds/devices
  - æ‰¹é‡ç»‘å®šè®¾å¤‡
- âŒ **å¯¼å…¥/å¯¼å‡º**
  - å¯¼å‡º Unit é…ç½®
  - å¯¼å…¥ Unit é…ç½®
- âŒ **æœç´¢å’Œç­›é€‰**
  - æŒ‰ unit_name, area_tag æœç´¢
  - æŒ‰ unit_type ç­›é€‰
- âŒ **å†å²è®°å½•**
  - æ˜¾ç¤º Unit/Bed/Device çš„å˜æ›´å†å²
  - å›æ»šåŠŸèƒ½

---

## ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

### Composables æ¨¡å—åŒ–
- âœ… `useBuilding.ts` - Building ç›¸å…³é€»è¾‘
- âœ… `useUnit.ts` - Unit ç›¸å…³é€»è¾‘
- âœ… `useRoom.ts` - Room ç›¸å…³é€»è¾‘
- âœ… `useBed.ts` - Bed ç›¸å…³é€»è¾‘
- âœ… `useDevice.ts` - Device ç›¸å…³é€»è¾‘

### å…³é”®å‡½æ•°

#### å·²å®ç°
- `ensureUnitRoom()` - ç¡®ä¿ unit_room å­˜åœ¨ï¼ˆroom_name === unit_nameï¼‰
- `getDeviceTypeIcon()` - è·å–è®¾å¤‡ç±»å‹å›¾æ ‡
- `getRoomDevices()` - è·å–ç»‘å®šåˆ° Room çš„è®¾å¤‡
- `getBedDevices()` - è·å–ç»‘å®šåˆ° Bed çš„è®¾å¤‡
- `getUnitDevices()` - è·å–ç»‘å®šåˆ° Unit çš„è®¾å¤‡ï¼ˆé€šè¿‡ unit_roomï¼‰

#### å ä½ç¬¦å‡½æ•°ï¼ˆå¾…å®ç°ï¼‰
- `getUnitCaregivers()` - è·å–ç»‘å®šåˆ° Unit çš„ Caregivers
- `getUnitResidents()` - è·å–ç»‘å®šåˆ° Unit çš„ Residents
- `handleEditDevice()` - ç¼–è¾‘è®¾å¤‡è¯¦ç»†ä¿¡æ¯

---

## ğŸ“Š åŠŸèƒ½å®Œæˆåº¦ç»Ÿè®¡

### æ€»ä½“è¿›åº¦
- **å·²å®ç°**: çº¦ 70%
- **å¾…å®ç°**: çº¦ 30%

### åˆ†ç±»è¿›åº¦

| åŠŸèƒ½æ¨¡å— | å·²å®ç° | å¾…å®ç° | å®Œæˆåº¦ |
|---------|--------|--------|--------|
| Building ç®¡ç† | 5/5 | 0 | 100% |
| Unit ç®¡ç† | 4/4 | 0 | 100% |
| Room ç®¡ç† | 5/5 | 0 | 100% |
| Bed ç®¡ç† | 4/4 | 0 | 100% |
| Device ç®¡ç† | 8/10 | 2 | 80% |
| Resident ç®¡ç† | 0/4 | 4 | 0% |
| Caregiver ç®¡ç† | 0/2 | 2 | 0% |
| é«˜çº§åŠŸèƒ½ | 0/4 | 4 | 0% |

---

## ğŸ¯ ä¼˜å…ˆçº§å»ºè®®

### P0 (é«˜ä¼˜å…ˆçº§ - æ ¸å¿ƒä¸šåŠ¡)
1. **Resident ç»‘å®šåŠŸèƒ½** - ä½æˆ·æ˜¯æ ¸å¿ƒä¸šåŠ¡å¯¹è±¡
2. **Caregiver ç»‘å®šåŠŸèƒ½** - æŠ¤ç†åˆ†é…éœ€è¦
3. **è®¾å¤‡ç¼–è¾‘åŠŸèƒ½** - å®Œå–„è®¾å¤‡ç®¡ç†

### P1 (ä¸­ä¼˜å…ˆçº§ - é‡è¦åŠŸèƒ½)
1. **å‘Šè­¦é…ç½®** - alarm_user_ids, alarm_tags
2. **å¸ƒå±€é…ç½®** - é›†æˆ vue_radar
3. **è®¾å¤‡çŠ¶æ€å®æ—¶æ›´æ–°** - WebSocket é›†æˆ

### P2 (ä½ä¼˜å…ˆçº§ - è¾…åŠ©åŠŸèƒ½)
1. **æ‰¹é‡æ“ä½œ** - æå‡æ•ˆç‡
2. **æœç´¢å’Œç­›é€‰** - æå‡ç”¨æˆ·ä½“éªŒ
3. **å¯¼å…¥/å¯¼å‡º** - æ•°æ®è¿ç§»
4. **å†å²è®°å½•** - å®¡è®¡åŠŸèƒ½

---

## ğŸ“ å¤‡æ³¨

1. **unit_room æ¦‚å¿µ**ï¼š
   - å½“ bed/dev ç»‘å®šåˆ° unit æ—¶ï¼Œè‡ªåŠ¨åˆ›å»º room_name === unit_name çš„ room
   - è¿™ä¸ª room ç§°ä¸º `unit_room`
   - é€šè¿‡ `ensureUnitRoom()` å‡½æ•°ç¡®ä¿å­˜åœ¨

2. **è®¾å¤‡ç»‘å®šè§„åˆ™**ï¼š
   - SleepPad åªèƒ½ç»‘å®šåˆ° Bed
   - å…¶ä»–è®¾å¤‡å¯ä»¥ç»‘å®šåˆ° Room æˆ– Bed
   - ç»‘å®šåˆ° Unit æ—¶ï¼Œè‡ªåŠ¨åˆ›å»º unit_room å¹¶ç»‘å®šåˆ° room

3. **ä¾èµ–æ£€æŸ¥**ï¼š
   - åˆ é™¤ Unit æ—¶æ£€æŸ¥ï¼šrooms, beds, devices, caregivers, residents
   - åˆ é™¤ Building æ—¶æ£€æŸ¥ï¼šunits
   - åˆ é™¤ Floor æ—¶æ£€æŸ¥ï¼šunits

4. **æ•°æ®åˆ·æ–°ç­–ç•¥**ï¼š
   - åˆ›å»º/æ›´æ–°/åˆ é™¤åè‡ªåŠ¨åˆ·æ–°ç›¸å…³åˆ—è¡¨
   - ä½¿ç”¨ `fetchRoomsWithBedsWrapper()` ç¡®ä¿æ•°æ®åŒæ­¥

